<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <title>Painel de Produtos | Admin</title>
</head>
<body class="bg-light">

<nav class="navbar navbar-dark bg-dark">
  <div class="container">
    <a class="navbar-brand" href="painel.html">⬅ Voltar</a>
  </div>
</nav>

<div class="container py-4">

  <h2 class="fw-bold mb-3">Gerenciar Produtos</h2>

  <!-- Formulário -->
  <div class="card p-3 mb-4">
    <h5 id="form-title">Adicionar novo produto</h5>

    <input id="nome" class="form-control mb-2" placeholder="Nome">
    <input id="preco" class="form-control mb-2" placeholder="Preço" type="number">
    <input id="categoria" class="form-control mb-2" placeholder="Categoria (PlayStation, Xbox, Nintendo)">
    <input id="imagem" class="form-control mb-2" placeholder="URL da imagem">
    <input id="estoque" class="form-control mb-2" placeholder="Estoque" type="number">

    <button class="btn btn-success w-100" onclick="salvarProduto()">Salvar</button>
  </div>

  <div id="lista"></div>

</div>

<script>
let editIndex = null;

// carrega produtos
function carregar() {
  let produtos = JSON.parse(localStorage.getItem("produtos")) || [];

  let html = `
    <table class="table table-striped">
      <thead>
        <tr>
          <th>Nome</th><th>Preço</th><th>Categoria</th><th>Estoque</th><th>Ações</th>
        </tr>
      </thead>
      <tbody>
  `;

  produtos.forEach((p, i) => {
    html += `
      <tr>
        <td>${p.nome}</td>
        <td>R$ ${p.preco}</td>
        <td>${p.categoria}</td>
        <td>${p.estoque}</td>
        <td>
          <button class="btn btn-sm btn-warning" onclick="editar(${i})">Editar</button>
          <button class="btn btn-sm btn-danger" onclick="remover(${i})">Excluir</button>
        </td>
      </tr>
    `;
  });

  html += "</tbody></table>";
  document.getElementById("lista").innerHTML = html;
}

function salvarProduto() {
  let produtos = JSON.parse(localStorage.getItem("produtos")) || [];

  const novo = {
    nome: nome.value,
    preco: Number(preco.value),
    categoria: categoria.value,
    imagem: imagem.value,
    estoque: Number(estoque.value)
  };

  if (editIndex === null) {
    produtos.push(novo);
  } else {
    produtos[editIndex] = novo;
    editIndex = null;
    document.getElementById("form-title").innerText = "Adicionar novo produto";
  }

  localStorage.setItem("produtos", JSON.stringify(produtos));
  carregar();

  nome.value = preco.value = categoria.value = imagem.value = estoque.value = "";
}

function editar(i) {
  let produtos = JSON.parse(localStorage.getItem("produtos"));

  nome.value = produtos[i].nome;
  preco.value = produtos[i].preco;
  categoria.value = produtos[i].categoria;
  imagem.value = produtos[i].imagem;
  estoque.value = produtos[i].estoque;

  editIndex = i;
  document.getElementById("form-title").innerText = "Editar produto";
}

function remover(i) {
  let produtos = JSON.parse(localStorage.getItem("produtos"));
  produtos.splice(i, 1);
  localStorage.setItem("produtos", JSON.stringify(produtos));
  carregar();
}

carregar();
</script>

</body>
</html>
