<!DOCTYPE html>
<html lang="pt-br">
<head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Painel | PangolesGames</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
  <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
  <div class="container">
    
    <a class="navbar-brand fw-bold d-flex align-items-center" href="index.html">
      <img src="IMG/banner.png" height="40" class="me-2" style="border-radius:5px;">
      PangolesGames
    </a>

    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse" id="navbarNav">
      <ul class="navbar-nav ms-auto">

        <li class="nav-item"><a class="nav-link" href="index.html">Início</a></li>
        <li class="nav-item"><a class="nav-link" href="produtos.html">Produtos</a></li>
        <li class="nav-item"><a class="nav-link" href="busca.html">Busca</a></li>
        <li class="nav-item"><a class="nav-link" href="carrinho.html">Carrinho</a></li>

      
        <li class="nav-item"><a class="nav-link" href="login.html">Login</a></li>
        <li class="nav-item"><a class="nav-link" href="registro.html">Registrar-se</a></li>

      </ul>
    </div>

  </div>
</nav>



  <main class="container py-5">
    <h1 class="mb-4">Painel do Vendedor</h1>
    <div id="orders-area"></div>
  </main>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    function requireSeller() {
      const cur = JSON.parse(localStorage.getItem('currentUser'));
      if (!cur || cur.role !== 'vendedor') { alert('Acesso negado. Faça login como vendedor.'); window.location.href='login.html'; }
    }
    requireSeller();

    function brl(n){ return n.toLocaleString('pt-BR',{minimumFractionDigits:2, maximumFractionDigits:2}); }
    function renderOrders() {
      const orders = JSON.parse(localStorage.getItem('pedidos')) || [];
      const area = document.getElementById('orders-area');
      if (!orders.length) { area.innerHTML = '<p class="text-muted">Nenhum pedido ainda.</p>'; return; }
      let html = '';
      orders.slice().reverse().forEach(o => {
        html += `<div class="card mb-3"><div class="card-body">
          <div class="d-flex justify-content-between"><h5>Pedido #${o.id}</h5><div><strong>${o.status}</strong></div></div>
          <p class="mb-1"><strong>Cliente:</strong> ${o.cliente.nome} — ${o.cliente.email}</p>
          <p class="mb-1"><strong>Total:</strong> R$ ${brl(o.total)}</p>
          <p class="mb-1"><strong>Pagamento:</strong> ${o.metodo} — ${o.codigoPagamento}</p>
          <p class="mb-1"><strong>Endereço:</strong> ${o.cliente.endereco}, ${o.cliente.cidade} - ${o.cliente.estado} (CEP ${o.cliente.cep})</p>
          <p class="mb-1"><strong>Itens:</strong></p><ul>`;
        o.itens.forEach(i => html += `<li>${i.nome} x${i.quantidade} — R$ ${brl(i.preco * i.quantidade)}</li>`);
        html += `</ul>
          <div class="d-flex gap-2">
            <button class="btn btn-sm btn-outline-primary" onclick="updateStatus(${o.id}, 'Pendente')">Pendente</button>
            <button class="btn btn-sm btn-outline-warning" onclick="updateStatus(${o.id}, 'Enviado')">Enviado</button>
            <button class="btn btn-sm btn-outline-success" onclick="updateStatus(${o.id}, 'Entregue')">Entregue</button>
          </div>
        </div></div>`;
      });
      area.innerHTML = html;
    }

    function updateStatus(id, status) {
      const orders = JSON.parse(localStorage.getItem('pedidos')) || [];
      const idx = orders.findIndex(o=>o.id===id);
      if (idx === -1) return;
      orders[idx].status = status;
      localStorage.setItem('pedidos', JSON.stringify(orders));
      renderOrders();
    }

    function logout(){ localStorage.removeItem('currentUser'); window.location.href='index.html'; }

    renderOrders();
  </script>
</body>
</html>
